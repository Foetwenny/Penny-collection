<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elongated Penny Collection</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="album-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700;900&family=Dancing+Script:wght@400;600;700&family=Great+Vibes&family=Merriweather:wght@300;400;700&family=Roboto:wght@300;400;500;700&family=Bebas+Neue&family=Oswald:wght@300;400;500;600;700&family=Lobster&family=Pacifico&family=Righteous&family=Fredoka+One&family=Comfortaa:wght@300;400;500;600;700&family=Quicksand:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Source+Code+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google AI Configuration -->
    <script>
        // Google AI Configuration - Load from config file
        window.GOOGLE_AI_CONFIG = {
            apiKey: '',
            projectId: ''
        };
        
        // Load configuration from external file
        fetch('./config.js')
            .then(response => response.text())
            .then(configText => {
                // Extract API key and project ID from config
                const apiKeyMatch = configText.match(/apiKey:\s*['"]([^'"]+)['"]/);
                const projectIdMatch = configText.match(/projectId:\s*['"]([^'"]+)['"]/);
                
                if (apiKeyMatch) window.GOOGLE_AI_CONFIG.apiKey = apiKeyMatch[1];
                if (projectIdMatch) window.GOOGLE_AI_CONFIG.projectId = projectIdMatch[1];
                
                if (!window.GOOGLE_AI_CONFIG.apiKey) {
                    console.warn('API key not found. Please check your config.js file.');
                }
            })
            .catch(error => {
                console.error('Failed to load configuration:', error);
                console.warn('Please create a config.js file with your API credentials.');
            });
    </script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-coins"></i> Traveler's Penny Log <i class="fas fa-globe"></i></h1>
                <p>Organize and display your pressed penny treasures</p>
                <div class="header-actions">
                    <div class="search-container">
                        <input type="text" id="searchInput" class="search-input" placeholder="Search albums, locations, descriptions...">
                        <button id="clearSearchBtn" class="clear-search-btn" style="display: none;" onclick="clearSearch()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <button id="createAlbumBtn" class="create-album-btn" onclick="openCreateAlbumModal()">
                        <i class="fas fa-plus"></i> Create New Album
                    </button>
                    <div class="menu-dropdown">
                        <button id="menuToggle" class="menu-toggle" onclick="toggleMenu()" title="Menu">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div id="menuDropdown" class="menu-dropdown-content">
                            <div class="menu-section">
                                <h4>Collection Management</h4>
                                <button onclick="saveCollectionAs()" class="menu-item">
                                    <i class="fas fa-download"></i> Save Collection As...
                                </button>
                                <button onclick="loadCollection()" class="menu-item">
                                    <i class="fas fa-upload"></i> Load Collection
                                </button>
                                <button onclick="importSharedAlbum()" class="menu-item">
                                    <i class="fas fa-share-alt"></i> Import Shared Album
                                </button>
                                <button onclick="createNewCollection()" class="menu-item">
                                    <i class="fas fa-plus"></i> New Collection
                                </button>
                            </div>

                            <div class="menu-section">
                                <h4>App Settings</h4>
                                <button onclick="openCollectionSettings()" class="menu-item">
                                    <i class="fas fa-edit"></i> Collection Name
                                </button>
                                <button onclick="openAIConfig()" class="menu-item">
                                    <i class="fas fa-robot"></i> AI Configuration
                                </button>
                                <button onclick="openDisplayPreferences()" class="menu-item">
                                    <i class="fas fa-palette"></i> Display Preferences
                                </button>
                            </div>
                            <div class="menu-section">
                                <h4>Help & Info</h4>
                                <button onclick="openUserGuide()" class="menu-item">
                                    <i class="fas fa-book-open"></i> User Guide
                                </button>
                                <button onclick="openAbout()" class="menu-item">
                                    <i class="fas fa-info-circle"></i> About
                                </button>
                                <button onclick="openVersionInfo()" class="menu-item">
                                    <i class="fas fa-code-branch"></i> Version Info
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Search Results Section -->
        <div id="searchResultsSection" class="search-results-section" style="display: none;">
            <div class="search-results-header">
                <div class="search-results-info">
                    <span id="searchResultsCount">0 results</span>
                    <span id="searchResultsQuery"></span>
                </div>
                <button id="showAllAlbumsBtn" class="show-all-btn" onclick="showAllAlbums()">
                                                    <i class="fas fa-times"></i> Clear Search
                </button>
            </div>
        </div>

        <main class="main-content">
            <!-- Album Management Section -->
            <section class="album-section">
                <div class="album-header">
                    <div class="collection-name-container">
                        <h2>
                            <i class="fas fa-book"></i> <span id="collectionNameDisplay">Your Albums</span>
                        </h2>
                    </div>
                </div>
                
                <!-- Collection Summary -->
                <div class="collection-summary" id="collectionSummary">
                    <div class="summary-content">
                        <div class="summary-stats">
                            <div class="stat-item">
                                <i class="fas fa-book"></i>
                                <span class="stat-number" id="albumCount">0</span>
                                <span class="stat-label">Albums</span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-coins"></i>
                                <span class="stat-number" id="pennyCount">0</span>
                                <span class="stat-label">Pennies</span>
                            </div>
                            <div class="last-backup-indicator" id="lastBackupIndicator">
                                <i class="fas fa-save"></i>
                                <span id="lastBackupText">Never saved</span>
                            </div>
                        </div>
                        
                        <div class="summary-controls">
                            <button id="toggleSharedBtn" class="toggle-shared-btn" onclick="toggleSharedAlbums()" title="Toggle shared albums visibility">
                                <i class="fas fa-share-alt"></i> Hide Shared
                            </button>
                            <button id="sortButton" class="sort-button" onclick="openSortOptions()" title="Change Sort Order">
                                <i class="fas fa-sort"></i> Sort
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="albums-grid" id="albumsGrid">
                    <!-- Albums will be dynamically added here -->
                </div>
                
                <div class="empty-albums-state" id="emptyAlbumsState" style="display: none;">
                    <i class="fas fa-book-open"></i>
                    <h3>No Albums Yet</h3>
                    <p>Create your first album to start organizing your penny collection!</p>
                    <button class="create-album-btn" onclick="openCreateAlbumModal()">
                        <i class="fas fa-plus"></i> Create Your First Album
                    </button>
                </div>
            </section>
        
            <!-- Create Album Modal -->
            <div class="modal" id="createAlbumModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Create New Album</h3>
                        <button class="close-btn" onclick="closeCreateAlbumModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="createAlbumForm">
                            <div class="form-group">
                                <label for="albumName">Album Name:</label>
                                <input type="text" id="albumName" required placeholder="e.g., Disney Collection, National Parks">
                            </div>
                            <div class="form-group">
                                <label for="albumDescription">Description:</label>
                                <textarea id="albumDescription" rows="3" placeholder="Describe what this album contains..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="albumCategory">Categories:</label>
                                <div class="category-checkboxes" id="albumCategoryCheckboxes">
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Theme Parks" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Theme Parks
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="National Parks" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            National Parks
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Historical Sites" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Historical Sites
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Museums" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Museums
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Zoos & Aquariums" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Zoos & Aquariums
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Mountains & Hiking" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Mountains & Hiking
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Cities & Urban" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Cities & Urban
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Small Towns" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Small Towns
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Road Trips" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Road Trips
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Vacation Destinations" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Vacation Destinations
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Educational" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Educational
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Entertainment" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Entertainment
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Sports & Recreation" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Sports & Recreation
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Cultural Events" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Cultural Events
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Seasonal" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Seasonal
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Other" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Other
                                        </label>
                                    </div>
                                </div>
                                <small>Select one or more categories to help organize and search your albums.</small>
                            </div>
                            <div class="form-group">
                                <label for="albumTripDate">Trip Date:</label>
                                <input type="date" id="albumTripDate">
                            </div>
                            <div class="form-group">
                                <label for="albumLocation">Location:</label>
                                <input type="text" id="albumLocation" placeholder="e.g., Disneyland, Yellowstone National Park">
                            </div>
                            <div class="form-group">
                                <label for="albumLocationUrl">Location URL (optional):</label>
                                <input type="url" id="albumLocationUrl" placeholder="https://earth.google.com/... or any map link">
                                <small>Add a Google Earth or map link to make the location clickable on the album card.</small>
                            </div>
                            <div class="form-group">
                                <label for="albumImageUrl">Background Image URL (optional):</label>
                                <input type="url" id="albumImageUrl" placeholder="https://i.imgur.com/... or any image URL">
                            </div>
                            <div class="form-group">
                                <label>Or Upload Local Image:</label>
                                <div class="album-image-upload-area" id="albumImageUploadArea">
                                    <div class="album-upload-content">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Drag & drop an image here or click to browse</p>
                                        <small>This will override the URL field above</small>
                                        <input type="file" id="albumImageInput" accept="image/*" hidden>
                                        <button type="button" class="album-upload-btn" id="albumChooseImageBtn">
                                            Choose Local Image
                                        </button>
                                    </div>
                                </div>
                                <div class="album-upload-preview" id="albumUploadPreview" style="display: none;">
                                    <img id="albumPreviewImage" src="" alt="Preview">
                                    <div class="album-preview-actions">
                                        <button type="button" class="album-reset-btn" onclick="resetAlbumImageUpload()">
                                            <i class="fas fa-times"></i> Remove Image
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="cancel-btn" onclick="closeCreateAlbumModal()">Cancel</button>
                        <button class="save-btn" onclick="createAlbum()">Create Album</button>
                    </div>
                </div>
            </div>
        
            <!-- Album View (Full Screen) -->
            <div id="albumViewScreen" class="album-view-screen" style="display: none;">
                <div class="album-view-header">
                    <button class="back-btn" onclick="closeAlbumView()">
                        <i class="fas fa-arrow-left"></i> Back to Albums
                    </button>
                    <div class="album-view-title">
                        <h2 id="albumViewTitle">Album Name</h2>
                        <button class="add-penny-btn" onclick="openAddPennyModal()">
                            <i class="fas fa-plus"></i> Add Penny
                        </button>
                        <button class="edit-album-btn" onclick="editCurrentAlbum()">
                            <i class="fas fa-edit"></i> Edit Album
                        </button>
                        <button class="delete-album-btn" onclick="deleteCurrentAlbum()">
                            <i class="fas fa-trash"></i> Delete Album
                        </button>
                    </div>
                </div>
                
                <div class="album-view-content">
                    <div class="album-info" id="albumInfo">
                        <!-- Album info will be displayed here -->
                    </div>

                    <!-- Analysis Results -->
                    <div class="analysis-section" id="analysisSection" style="display: none;">
                        <div class="analysis-card">
                            <h4><i class="fas fa-brain"></i> AI Analysis Results</h4>
                            <div class="analysis-content">
                                <div class="analysis-item">
                                    <label>Description:</label>
                                    <p id="descriptionResult">Analyzing...</p>
                                </div>
                            </div>
                            <div class="analysis-actions">
                                <button class="save-btn" id="saveBtn">
                                    <i class="fas fa-save"></i> Save to Album
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Pennies in Album -->
                    <div class="album-pennies">
                        <div class="pennies-header">
                            <h4><i class="fas fa-coins"></i> Pennies in this Album</h4>
                            <button id="pennySortButton" class="penny-sort-button" onclick="openPennySortOptions()" title="Change Penny Sort Order">
                                <i class="fas fa-sort"></i> Sort
                            </button>
                        </div>
                        <div class="pennies-grid" id="penniesGrid">
                            <!-- Pennies will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        
            <!-- Edit Penny Modal -->
            <div class="modal" id="editModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Edit Penny Details</h3>
                    </div>
                    <div class="modal-body">
                        <form id="editForm">
                            <!-- Current Image Display -->
                            <div class="form-group">
                                <label>Current Image:</label>
                                <div class="edit-penny-current-image" id="editPennyCurrentImage">
                                    <img id="editPennyCurrentImagePreview" src="" alt="Current penny image">
                                </div>
                            </div>
                            
                            <!-- Image Change Section -->
                            <div class="form-group">
                                <label>Change Image:</label>
                                <div class="edit-penny-upload-area" id="editPennyUploadArea">
                                    <div class="edit-penny-upload-content">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Drag & drop a new image here or click to browse</p>
                                        <input type="file" id="editPennyImageInput" accept="image/*" hidden>
                                        <button type="button" class="edit-penny-upload-btn" id="editPennyChooseImageBtn">
                                            Choose New Image
                                        </button>
                                    </div>
                                </div>
                                <div class="edit-penny-upload-preview" id="editPennyUploadPreview" style="display: none;">
                                    <img id="editPennyPreviewImage" src="" alt="Preview">
                                    <div class="edit-penny-preview-actions">
                                        <button type="button" class="edit-penny-reset-btn" onclick="resetEditPennyImageUpload()">
                                            <i class="fas fa-times"></i> Cancel Change
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="editName">Name/Title:</label>
                                <input type="text" id="editName" required>
                            </div>
                            <div class="form-group">
                                <label for="editLocation">Location:</label>
                                <input type="text" id="editLocation" required>
                            </div>
                            <div class="form-group">
                                <label for="editLocationUrl">Location URL (optional):</label>
                                <input type="url" id="editLocationUrl" placeholder="https://maps.google.com/... or other map link">
                            </div>
                            <div class="form-group">
                                <label for="editDescription">Description:</label>
                                <div id="editDescription" class="rich-text-editor" contenteditable="true" data-placeholder="Describe the penny design and details..."></div>
                            </div>
                            <div class="form-group">
                                <label for="editDate">Date Collected:</label>
                                <input type="date" id="editDate">
                            </div>
                            <div class="form-group">
                                <label for="editNotes">Personal Notes:</label>
                                <textarea id="editNotes" rows="3"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="cancel-btn" onclick="closeModal()">Cancel</button>
                        <button class="save-btn" onclick="saveEdit()">Save Changes</button>
                    </div>
                </div>
            </div>

            <!-- Move Penny Modal -->
            <div class="modal" id="movePennyModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Move Penny to Album</h3>
                        <button class="close-btn" onclick="closeMovePennyModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="move-penny-info">
                            <p><strong>Moving penny:</strong> <span id="movePennyName"></span></p>
                            <p><strong>From album:</strong> <span id="moveFromAlbum"></span></p>
                        </div>
                        <div class="album-selection">
                            <h4>Select destination album:</h4>
                            <div id="moveAlbumList" class="album-list">
                                <!-- Album options will be populated here -->
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeMovePennyModal()">Cancel</button>
                            <button class="btn btn-primary" id="movePennyBtn" onclick="confirmMovePenny()" disabled>Move Penny</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Penny Sort Options Modal -->
            <div class="modal" id="pennySortOptionsModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-sort"></i> Sort Pennies</h3>
                        <button class="close-btn" onclick="closePennySortOptions()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="sort-options">
                            <div class="sort-group">
                                <div class="sort-group-header">
                                    <input type="radio" id="pennySortName" name="pennySort" value="name">
                                    <label for="pennySortName">Penny Name</label>
                                </div>
                                <div class="sort-direction-buttons">
                                    <button class="sort-direction-btn" data-sort="name" data-direction="asc" onclick="selectPennySortDirection('name', 'asc')">
                                        <i class="fas fa-sort-alpha-down"></i> A to Z
                                    </button>
                                    <button class="sort-direction-btn" data-sort="name" data-direction="desc" onclick="selectPennySortDirection('name', 'desc')">
                                        <i class="fas fa-sort-alpha-up"></i> Z to A
                                    </button>
                                </div>
                            </div>
                            
                            <div class="sort-group">
                                <div class="sort-group-header">
                                    <input type="radio" id="pennySortDate" name="pennySort" value="date">
                                    <label for="pennySortDate">Collection Date</label>
                                </div>
                                <div class="sort-direction-buttons">
                                    <button class="sort-direction-btn" data-sort="date" data-direction="desc" onclick="selectPennySortDirection('date', 'desc')">
                                        <i class="fas fa-sort-amount-down"></i> Newest First
                                    </button>
                                    <button class="sort-direction-btn" data-sort="date" data-direction="asc" onclick="selectPennySortDirection('date', 'asc')">
                                        <i class="fas fa-sort-amount-up"></i> Oldest First
                                    </button>
                                </div>
                            </div>
                            
                            <div class="sort-group">
                                <div class="sort-group-header">
                                    <input type="radio" id="pennySortLocation" name="pennySort" value="location">
                                    <label for="pennySortLocation">Location</label>
                                </div>
                                <div class="sort-direction-buttons">
                                    <button class="sort-direction-btn" data-sort="location" data-direction="asc" onclick="selectPennySortDirection('location', 'asc')">
                                        <i class="fas fa-sort-alpha-down"></i> A to Z
                                    </button>
                                    <button class="sort-direction-btn" data-sort="location" data-direction="desc" onclick="selectPennySortDirection('location', 'desc')">
                                        <i class="fas fa-sort-alpha-up"></i> Z to A
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="save-btn" onclick="closePennySortOptions()">Close</button>
                    </div>
                    </div>
                </div>
            </div>

            <!-- Edit Album Modal -->
            <div class="modal" id="editAlbumModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Edit Album</h3>
                        <button class="close-btn" onclick="closeEditAlbumModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="editAlbumForm">
                            <div class="form-group">
                                <label for="editAlbumName">Album Name:</label>
                                <input type="text" id="editAlbumName" required>
                            </div>
                            <div class="form-group">
                                <label for="editAlbumDescription">Description:</label>
                                <textarea id="editAlbumDescription" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="editAlbumCategory">Categories:</label>
                                <div class="category-checkboxes" id="editAlbumCategoryCheckboxes">
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Theme Parks" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Theme Parks
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="National Parks" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            National Parks
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Historical Sites" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Historical Sites
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Museums" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Museums
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Zoos & Aquariums" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Zoos & Aquariums
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Mountains & Hiking" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Mountains & Hiking
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Cities & Urban" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Cities & Urban
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Small Towns" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Small Towns
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Road Trips" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Road Trips
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Vacation Destinations" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Vacation Destinations
                                        </label>

                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Educational" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Educational
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Entertainment" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Entertainment
                                        </label>
                                    </div>
                                    <div class="category-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Sports & Recreation" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Sports & Recreation
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Cultural Events" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Cultural Events
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Seasonal" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Seasonal
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" value="Other" class="category-checkbox">
                                            <span class="checkmark"></span>
                                            Other
                                        </label>
                                    </div>
                                </div>
                                <small>Select one or more categories to help organize and search your albums.</small>
                            </div>
                            <div class="form-group">
                                <label for="editAlbumTripDate">Trip Date:</label>
                                <input type="date" id="editAlbumTripDate">
                            </div>
                            <div class="form-group">
                                <label for="editAlbumLocation">Location:</label>
                                <input type="text" id="editAlbumLocation" placeholder="e.g., Disneyland, Yellowstone National Park">
                            </div>
                            <div class="form-group">
                                <label for="editAlbumLocationUrl">Location URL (optional):</label>
                                <input type="url" id="editAlbumLocationUrl" placeholder="https://earth.google.com/... or any map link">
                                <small>Add a Google Earth or map link to make the location clickable on the album card.</small>
                            </div>
                            <div class="form-group">
                                <label for="editAlbumImageUrl">Background Image URL (optional):</label>
                                <input type="url" id="editAlbumImageUrl" placeholder="https://i.imgur.com/... or any image URL">
                            </div>
                            <div class="form-group">
                                <small>Tip: You can use public image links (e.g., Imgur). The image will be displayed as the album card background.</small>
                            </div>
                            <div class="form-group">
                                <label>Or Upload Local Image:</label>
                                <div class="album-image-upload-area" id="editAlbumImageUploadArea">
                                    <input type="file" id="editAlbumImageFileInput" accept="image/*" style="display: none;">
                                    <div class="album-upload-content" id="editAlbumUploadContent">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Drag and drop an image here</p>
                                        <p>or</p>
                                        <button type="button" class="upload-btn" onclick="document.getElementById('editAlbumImageFileInput').click()">
                                            <i class="fas fa-folder-open"></i> Browse Files
                                        </button>
                                    </div>
                                    <div class="album-upload-preview" id="editAlbumUploadPreview" style="display: none;">
                                        <img id="editAlbumPreviewImage" src="" alt="Preview">
                                        <div class="album-preview-controls">
                                            <button type="button" class="remove-upload-btn" onclick="resetEditAlbumImageUpload()">
                                                <i class="fas fa-times"></i> Remove
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="cancel-btn" onclick="closeEditAlbumModal()">Cancel</button>
                        <button class="save-btn" onclick="saveAlbumEdit()">Save Album</button>
                    </div>
                </div>
            </div>

            <!-- Add Penny Modal -->
            <div class="modal" id="addPennyModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add New Penny</h3>
                        <button class="close-btn" onclick="closeAddPennyModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-content">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Drag & drop an image here or click to browse</p>
                                <input type="file" id="imageInput" accept="image/*" hidden>
                                <button class="upload-btn" id="chooseImageBtn">
                                    Choose Image
                                </button>
                            </div>
                        </div>
                        <div class="upload-preview" id="uploadPreview" style="display: none;">
                            <img id="previewImage" src="" alt="Preview">
                            <div class="preview-actions">
                                <button class="analyze-btn" id="analyzeBtn">
                                    <i class="fas fa-magic"></i> Analyze with AI
                                </button>
                                <button class="manual-entry-btn" id="manualEntryBtn">
                                    <i class="fas fa-edit"></i> Enter Details Manually
                                </button>
                                <button class="reset-btn" onclick="resetUpload()">
                                    <i class="fas fa-times"></i> Reset
                                </button>
                            </div>
                        </div>
                        
                        <!-- Manual Entry Form -->
                        <div class="manual-entry-form" id="manualEntryForm" style="display: none;">
                            <h4><i class="fas fa-edit"></i> Penny Details</h4>
                            <form id="pennyEntryForm">
                                <div class="form-group">
                                    <label for="pennyName">Name/Title:</label>
                                    <input type="text" id="pennyName" required placeholder="What does this penny commemorate?">
                                </div>
                                <div class="form-group">
                                    <label for="pennyLocation">Location:</label>
                                    <input type="text" id="pennyLocation" required placeholder="Where did you collect this penny?">
                                </div>
                                <div class="form-group">
                                    <label for="pennyLocationUrl">Location URL (optional):</label>
                                    <input type="url" id="pennyLocationUrl" placeholder="https://maps.google.com/... or other map link">
                                </div>
                                <div class="form-group">
                                    <label for="pennyDescription">Description:</label>
                                    <div id="pennyDescription" class="rich-text-editor" contenteditable="true" data-placeholder="Describe the penny design and details..."></div>
                                </div>
                                <div class="form-group">
                                    <label for="pennyDate">Date Collected:</label>
                                    <input type="date" id="pennyDate">
                                </div>
                                <div class="form-group">
                                    <label for="pennyNotes">Personal Notes:</label>
                                    <textarea id="pennyNotes" rows="2" placeholder="Any memories or observations..."></textarea>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Analysis Results -->
                        <div class="analysis-section" id="analysisSection" style="display: none;">
                            <div class="analysis-card">
                                <h4><i class="fas fa-brain"></i> AI Analysis Results</h4>
                                <div class="analysis-content">
                                    <div class="analysis-item">
                                        <label>Description:</label>
                                        <p id="descriptionResult" class="description-text">Analyzing...</p>
                                    </div>
                                </div>
                                <div class="analysis-actions">
                                    <button class="save-btn" id="saveBtn">
                                        <i class="fas fa-save"></i> Save to Album
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="cancel-btn" onclick="closeAddPennyModal()">Cancel</button>
                        <button class="save-btn" id="saveManualPennyBtn" style="display: none;" onclick="saveManualPenny()">
                            <i class="fas fa-save"></i> Save Penny
                        </button>
                    </div>
                </div>
            </div>

            <!-- Penny View Modal -->
            <div class="modal" id="pennyViewModal">
                <div class="modal-content penny-view-content">
                    <div class="modal-header">
                        <div class="penny-nav-controls">
                            <button class="penny-nav-btn prev-btn" onclick="navigateToPreviousPenny()" title="Previous Penny">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="penny-nav-btn next-btn" onclick="navigateToNextPenny()" title="Next Penny">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <h3 id="pennyViewTitle">Penny Details</h3>
                        <button class="close-btn" onclick="closePennyViewModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="penny-view-image">
                            <img id="pennyViewImage" src="" alt="Penny Image">
                        </div>
                        <div class="penny-view-info">
                            <h4 id="pennyViewName"></h4>
                            <p><strong>Location:</strong> <span id="pennyViewLocation"></span></p>
                            <p><strong>Date Collected:</strong> <span id="pennyViewDate"></span></p>
                            <p><strong>Description:</strong></p>
                            <p id="pennyViewDescription" class="penny-description"></p>
                            <p style="display: none;"><strong>Personal Notes:</strong></p>
                            <p id="pennyViewNotes" style="display: none;"></p>
                        </div>
                    </div>
                </div>
            </div>

                         <!-- Sort Options Modal -->
             <div class="modal" id="sortOptionsModal">
                 <div class="modal-content">
                     <div class="modal-header">
                         <h3><i class="fas fa-sort"></i> Sort Albums</h3>
                         <button class="close-btn" onclick="closeSortOptionsModal()">
                             <i class="fas fa-times"></i>
                         </button>
                     </div>
                     <div class="modal-body">
                         <div class="sort-options">
                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="dateCreated" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Date Created</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="dateCreated" data-direction="desc">
                                         <i class="fas fa-sort-amount-down"></i> Newest First
                                     </button>
                                     <button class="direction-btn" data-sort="dateCreated" data-direction="asc">
                                         <i class="fas fa-sort-amount-up"></i> Oldest First
                                     </button>
                                 </div>
                             </div>

                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="tripDate" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Trip Date</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="tripDate" data-direction="desc">
                                         <i class="fas fa-sort-amount-down"></i> Most Recent Trip
                                     </button>
                                     <button class="direction-btn" data-sort="tripDate" data-direction="asc">
                                         <i class="fas fa-sort-amount-up"></i> Oldest Trip
                                     </button>
                                 </div>
                             </div>

                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="albumName" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Album Name</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="albumName" data-direction="asc">
                                         <i class="fas fa-sort-alpha-down"></i> A to Z
                                     </button>
                                     <button class="direction-btn" data-sort="albumName" data-direction="desc">
                                         <i class="fas fa-sort-alpha-up"></i> Z to A
                                     </button>
                                 </div>
                             </div>

                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="location" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Location</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="location" data-direction="asc">
                                         <i class="fas fa-sort-alpha-down"></i> A to Z
                                     </button>
                                     <button class="direction-btn" data-sort="location" data-direction="desc">
                                         <i class="fas fa-sort-alpha-up"></i> Z to A
                                     </button>
                                 </div>
                             </div>

                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="pennyCount" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Penny Count</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="pennyCount" data-direction="desc">
                                         <i class="fas fa-sort-amount-down"></i> Most Pennies
                                     </button>
                                     <button class="direction-btn" data-sort="pennyCount" data-direction="asc">
                                         <i class="fas fa-sort-amount-up"></i> Least Pennies
                                     </button>
                                 </div>
                             </div>

                             <div class="sort-option">
                                 <label class="sort-option-label">
                                     <input type="radio" name="sortBy" value="lastModified" class="sort-radio">
                                     <span class="radio-checkmark"></span>
                                     <span class="sort-text">Last Modified</span>
                                 </label>
                                 <div class="sort-direction">
                                     <button class="direction-btn" data-sort="lastModified" data-direction="desc">
                                         <i class="fas fa-sort-amount-down"></i> Recently Updated
                                     </button>
                                     <button class="direction-btn" data-sort="lastModified" data-direction="asc">
                                         <i class="fas fa-sort-amount-up"></i> Oldest Update
                                     </button>
                                 </div>
                             </div>
                         </div>
                     </div>
                                         <div class="modal-footer">
                        <button class="save-btn" onclick="closeSortOptionsModal()">Close</button>
                    </div>
                 </div>
             </div>

             <!-- User Guide Modal -->
             <div class="modal" id="userGuideModal">
                 <div class="modal-content user-guide-content">
                     <div class="modal-header">
                         <h3><i class="fas fa-book-open"></i> User Guide</h3>
                         <button class="close-btn" onclick="closeUserGuideModal()">
                             <i class="fas fa-times"></i>
                         </button>
                     </div>
                     <div class="modal-body">
                        <div class="guide-navigation">
                            <button class="guide-nav-btn active" data-section="getting-started">Getting Started</button>
                            <button class="guide-nav-btn" data-section="collection">Collection</button>
                            <button class="guide-nav-btn" data-section="albums">Albums</button>
                            <button class="guide-nav-btn" data-section="search-sort">Search & Sort</button>
                            <button class="guide-nav-btn" data-section="pennies">Pennies</button>
                            <button class="guide-nav-btn" data-section="features">Features</button>
                        </div>
                         
                         <div class="guide-content">
                             <!-- Getting Started Section -->
                             <div class="guide-section active" id="getting-started">
                                 <h4><i class="fas fa-rocket"></i> Getting Started</h4>
                                 <p>Welcome to Traveler's Penny Log! This app helps you organize and display your pressed penny collection.</p>
                                 
                                 <h5>Quick Start:</h5>
                                 <ol>
                                     <li><strong>Create Your First Album:</strong> Click the "Create New Album" button in the header</li>
                                     <li><strong>Add Details:</strong> Fill in the album name, description, and select categories</li>
                                     <li><strong>Add Pennies:</strong> Open the album and click "Add Penny" to start your collection</li>
                                 </ol>
                                 
                                 <h5>Navigation:</h5>
                                 <ul>
                                     <li><strong>Header:</strong> Search bar, create album button, and menu</li>
                                     <li><strong>Menu (⋮):</strong> Access to advanced features, settings, and help</li>
                                     <li><strong>Album Cards:</strong> Click to open full album view</li>
                                 </ul>
                            </div>
                            
                            <!-- Collection Section -->
                            <div class="guide-section" id="collection">
                                <h4><i class="fas fa-folder-open"></i> Collection Overview</h4>
                                
                                <h5>Collection Nameplate:</h5>
                                <ul>
                                    <li><strong>Customization:</strong> Change your collection name from the menu under Collection Management</li>
                                    <li><strong>Personal Touch:</strong> Give your collection a unique name that reflects your collecting journey</li>
                                    <li><strong>Display:</strong> The collection name appears prominently at the top of your collection view</li>
                                </ul>
                                
                                <h5>Collection Status Bar:</h5>
                                <ul>
                                    <li><strong>Statistics:</strong> Shows total albums, total pennies, and last backup time</li>
                                    <li><strong>Sort Button:</strong> Access album sorting options to organize your collection</li>
                                    <li><strong>Shared Albums Toggle:</strong> Hide or show imported shared albums in your collection</li>
                                    <li><strong>Visual Indicators:</strong> Shared albums are marked with brown "Shared Album" badges</li>
                                </ul>
                                
                                <h5>Collection Management:</h5>
                                <ul>
                                    <li><strong>Backup Status:</strong> Status bar shows when your collection was last backed up</li>
                                    <li><strong>Import Options:</strong> Load full collections or merge shared albums into existing collection</li>
                                    <li><strong>Export Options:</strong> Save entire collection or share individual albums</li>
                                </ul>
                            </div>
                            
                            <!-- Albums Section -->
                             <div class="guide-section" id="albums">
                                 <h4><i class="fas fa-book"></i> Managing Albums</h4>
                                 
                                 <h5>Creating Albums:</h5>
                                 <ul>
                                     <li><strong>Name:</strong> Choose a descriptive name for your collection</li>
                                     <li><strong>Description:</strong> Add details about what the album contains</li>
                                     <li><strong>Categories:</strong> Select one or more categories to help organize and search</li>
                                     <li><strong>Trip Date:</strong> When you visited the location (optional)</li>
                                     <li><strong>Location:</strong> Where you collected the pennies</li>
                                     <li><strong>Location URL:</strong> Add a map link to make the location clickable</li>
                                     <li><strong>Background Image:</strong> Add a cover image for visual appeal</li>
                                 </ul>
                                 
                                <h5>Album Actions:</h5>
                                <ul>
                                    <li><strong>View:</strong> Click the album card to see all details and pennies</li>
                                    <li><strong>Edit:</strong> Modify album information anytime</li>
                                    <li><strong>Share:</strong> Export individual albums to share with others</li>
                                    <li><strong>Delete:</strong> Remove albums you no longer need</li>
                                </ul>
                             </div>
                             
                             <!-- Search & Sort Section -->
                             <div class="guide-section" id="search-sort">
                                 <h4><i class="fas fa-search"></i> Search & Organization</h4>
                                 
                                <h5>Search:</h5>
                                <ul>
                                    <li><strong>Search Bar:</strong> Find albums by name, description, location, or penny details</li>
                                    <li><strong>Categories:</strong> Search by album categories (e.g., "Theme Parks", "National Parks")</li>
                                    <li><strong>Shared Albums:</strong> Search for "shared" to find all imported albums from other collections</li>
                                    <li><strong>Results:</strong> See highlighted matches and which fields contained your search term</li>
                                    <li><strong>Matched Pennies:</strong> When opening an album from search results, matching pennies appear first in the grid</li>
                                </ul>
                                
                                <h5>Filtering:</h5>
                                <ul>
                                    <li><strong>Shared Albums Toggle:</strong> Use "Hide Shared" / "Show Shared" button to filter imported albums</li>
                                </ul>
                                 
                                <h5>Sorting:</h5>
                                <ul>
                                    <li><strong>Album Sorting:</strong> Sort albums in the collection view by various criteria</li>
                                    <li><strong>Penny Sorting:</strong> Sort pennies within individual albums by name, date, or location</li>
                                </ul>
                                 
                                 <p><strong>Tip:</strong> Your sort preference is saved and applied automatically!</p>
                             </div>
                             
                             <!-- Pennies Section -->
                             <div class="guide-section" id="pennies">
                                 <h4><i class="fas fa-coins"></i> Managing Pennies</h4>
                                 
                                 <h5>Adding Pennies:</h5>
                                 <ul>
                                     <li><strong>Upload Image:</strong> Drag & drop or click to browse for penny photos. For best results, use JPEG format at 800x600 pixels or higher resolution</li>
                                                                           <li><strong>AI Analysis:</strong> Use AI to automatically identify and describe the penny - setup instructions available in the menu</li>
                                     <li><strong>Manual Entry:</strong> Enter all penny details manually without AI analysis</li>
                                     <li><strong>Flexible Workflow:</strong> Choose between AI assistance or manual entry based on your preference</li>
                                 </ul>
                                 
                                <h5>Penny Information:</h5>
                                <ul>
                                    <li><strong>Name/Title:</strong> What the penny commemorates</li>
                                    <li><strong>Location:</strong> Where you collected it</li>
                                    <li><strong>Location URL:</strong> Optional map link - makes location clickable on penny cards</li>
                                    <li><strong>Description:</strong> Details about the penny design</li>
                                    <li><strong>Date Collected:</strong> When you got the penny</li>
                                    <li><strong>Personal Notes:</strong> Your memories or observations</li>
                                </ul>
                                 
                                <h5>Penny Actions:</h5>
                                <ul>
                                    <li><strong>View:</strong> Click penny images to see full details</li>
                                    <li><strong>Edit:</strong> Modify penny information anytime</li>
                                    <li><strong>Move:</strong> Transfer pennies to other albums</li>
                                    <li><strong>Delete:</strong> Remove pennies from albums</li>
                                </ul>
                             </div>
                             
                             <!-- Features Section -->
                             <div class="guide-section" id="features">
                                 <h4><i class="fas fa-star"></i> App Features</h4>
                                 
                                <h5>Data Management:</h5>
                                <ul>
                                    <li><strong>Export Backup:</strong> Download your collection as a JSON file</li>
                                    <li><strong>Import Backup:</strong> Restore your collection (or a shared collection) from a backup file</li>
                                    <li><strong>Import Shared Albums:</strong> Add shared albums to your existing collection without replacing it</li>
                                    <li><strong>Local Storage:</strong> All data is saved locally in your browser</li>
                                </ul>
                                 
                                <h5>Menu Features:</h5>
                                <ul>
                                    <li><strong>Collection Management:</strong> Backup and restore your data</li>
                                    <li><strong>App Settings:</strong> Configure AI and display preferences</li>
                                    <li><strong>Help & Info:</strong> Access this guide and app information</li>
                                </ul>
                                 
                                <h5>Tips:</h5>
                                <ul>
                                    <li>Use categories to organize related albums (e.g., "Theme Parks" + "Family Vacations")</li>
                                    <li>Add location URLs to make album cards clickable for maps</li>
                                    <li>Add location URLs to individual pennies for quick access to maps - perfect for misc albums</li>
                                    <li>Search works across all album and penny fields</li>
                                    <li>Your preferences (dark mode, sort order) are automatically saved</li>
                                </ul>
                             </div>
                         </div>
                     </div>
                     <div class="modal-footer">
                         <button class="cancel-btn" onclick="closeUserGuideModal()">Close Guide</button>
                         <button class="guide-nav-btn" onclick="openUserGuideInNewTab()">
                             <i class="fas fa-external-link-alt"></i> Open in New Tab
                         </button>
                     </div>
                                 </div>
            </div>

            <!-- About Modal -->
            <div class="modal" id="aboutModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-info-circle"></i> About Traveler's Penny Log</h3>
                        <button class="close-btn" onclick="closeAboutModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="about-content">
                            <div class="about-header">
                                <i class="fas fa-coins about-icon"></i>
                                <h4>Traveler's Penny Log</h4>
                                <p class="about-subtitle">Your Digital Pressed Penny Collection</p>
                            </div>
                            
                            <div class="about-description">
                                <p>A modern, AI-powered web application designed for organizing and displaying your elongated penny collection. Perfect for collectors who want to preserve memories of their travels and showcase their pressed penny adventures.</p>
                            </div>

                            <div class="about-features">
                                <h5><i class="fas fa-star"></i> Key Features</h5>
                                <ul>
                                    <li><i class="fas fa-photo-video"></i> Smart album organization with customizable categories</li>
                                    <li><i class="fas fa-robot"></i> AI-powered penny identification and description</li>
                                    <li><i class="fas fa-upload"></i> Drag & drop image uploads with automatic compression</li>
                                    <li><i class="fas fa-search"></i> Advanced search and sorting capabilities</li>
                                    <li><i class="fas fa-volume-up"></i> Immersive audio feedback system with customizable sounds</li>
                                    <li><i class="fas fa-palette"></i> Display preferences with 6 color themes and sound controls</li>
                                    <li><i class="fas fa-shield-alt"></i> Local data storage for privacy and offline access</li>
                                    <li><i class="fas fa-download"></i> Export/import for backup and sharing</li>
                                    <li><i class="fas fa-share-alt"></i> Share individual albums as JSON files</li>
                                    <li><i class="fas fa-save"></i> Enhanced collection management with automatic backups</li>
                                    <li><i class="fas fa-clock"></i> Smart modification tracking to encourage regular backups</li>
                                    <li><i class="fas fa-mobile-alt"></i> Responsive design for all devices</li>
                                </ul>
                            </div>

                            <div class="about-tech">
                                <h5><i class="fas fa-cog"></i> Technology</h5>
                                <p><i class="fas fa-brain"></i> <strong>Powered by Google Gemini AI</strong> for intelligent penny analysis and descriptions</p>
                                <p><i class="fas fa-volume-up"></i> <strong>Web Audio API</strong> for immersive sound feedback and audio controls</p>
                                <p><i class="fas fa-lock"></i> <strong>Privacy First:</strong> Your data stays private - everything is stored locally in your browser</p>
                            </div>

                            <div class="about-footer">
                                <p><i class="fas fa-heart"></i> Made with love for penny collectors everywhere</p>
                                <p class="about-version">Version 2.2 - Enhanced Collection Management & Album Sharing</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="save-btn" onclick="closeAboutModal()">Close</button>
                    </div>
                </div>
            </div>

            <!-- Version Info Modal -->
            <div class="modal" id="versionInfoModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-code-branch"></i> Version Information</h3>
                        <button class="close-btn" onclick="closeVersionInfoModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="version-content">
                            <div class="version-current">
                                <h4><i class="fas fa-tag"></i> Current Version</h4>
                                <div class="version-badge">
                                    <span class="version-number">2.2.0</span>
                                    <span class="version-name">Collection Management Enhanced</span>
                                </div>
                                <p class="version-date">Latest Release</p>
                            </div>

                            <div class="version-changelog">
                                <h4><i class="fas fa-list-ul"></i> What's New in 2.2</h4>
                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-share-alt"></i>
                                        <strong>Album Sharing</strong>
                                        <span class="changelog-badge new">NEW</span>
                                    </div>
                                    <p>Share individual albums as JSON files with the new share button on each album card</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-save"></i>
                                        <strong>Enhanced Collection Management</strong>
                                        <span class="changelog-badge improved">IMPROVED</span>
                                    </div>
                                    <p>Improved "Save Collection As..." and "Load Collection" with better naming, validation, and automatic backups</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-clock"></i>
                                        <strong>Smart Modification Tracking</strong>
                                        <span class="changelog-badge new">NEW</span>
                                    </div>
                                    <p>Last modified indicator tracks your activity and encourages regular backups</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-palette"></i>
                                        <strong>Earth-Tone Design</strong>
                                        <span class="changelog-badge improved">IMPROVED</span>
                                    </div>
                                    <p>Refined color scheme with earth-tone action buttons that complement the overall design</p>
                                </div>

                                <h4><i class="fas fa-list-ul"></i> Previous Updates (2.1)</h4>
                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-volume-up"></i>
                                        <strong>Immersive Audio System</strong>
                                        <span class="changelog-badge new">NEW</span>
                                    </div>
                                    <p>Complete audio feedback system with customizable sounds for all interactions - page turns, coin clicks, menu sounds, and more</p>
                                </div>
                                
                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-palette"></i>
                                        <strong>Display Preferences</strong>
                                        <span class="changelog-badge new">NEW</span>
                                    </div>
                                    <p>New preferences modal with sound controls, volume adjustment, and dark mode toggle</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-cog"></i>
                                        <strong>UI/UX Improvements</strong>
                                        <span class="changelog-badge improved">IMPROVED</span>
                                    </div>
                                    <p>Fixed checkbox styling, improved modal interactions, and enhanced user experience throughout the app</p>
                                </div>

                                <h4><i class="fas fa-list-ul"></i> Previous Updates (2.0)</h4>
                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-robot"></i>
                                        <strong>AI-Powered Analysis</strong>
                                        <span class="changelog-badge new">NEW</span>
                                    </div>
                                    <p>Integrated Google Gemini AI for automatic penny identification and detailed descriptions</p>
                                </div>
                                
                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-upload"></i>
                                        <strong>Enhanced Image Upload</strong>
                                        <span class="changelog-badge improved">IMPROVED</span>
                                    </div>
                                    <p>Added drag & drop support for album background images in both create and edit modals</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-sort"></i>
                                        <strong>Instant Sorting</strong>
                                        <span class="changelog-badge improved">IMPROVED</span>
                                    </div>
                                    <p>Sort options now apply immediately without needing to click "Apply"</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-calendar"></i>
                                        <strong>Date Handling</strong>
                                        <span class="changelog-badge fixed">FIXED</span>
                                    </div>
                                    <p>Resolved timezone issues causing dates to display incorrectly</p>
                                </div>

                                <div class="changelog-item">
                                    <div class="changelog-header">
                                        <i class="fas fa-shield-alt"></i>
                                        <strong>Privacy & Security</strong>
                                        <span class="changelog-badge enhanced">ENHANCED</span>
                                    </div>
                                    <p>All data remains local to your browser - no cloud storage or tracking</p>
                                </div>
                            </div>

                            <div class="version-technical">
                                <h4><i class="fas fa-cog"></i> Technical Details</h4>
                                <div class="tech-grid">
                                    <div class="tech-item">
                                        <strong>Platform:</strong>
                                        <span>Progressive Web App (PWA)</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>Storage:</strong>
                                        <span>Local Browser Storage</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>AI Engine:</strong>
                                        <span>Google Gemini 2.5 Flash</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>Audio System:</strong>
                                        <span>Web Audio API</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>Image Processing:</strong>
                                        <span>Client-side Compression</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>Compatibility:</strong>
                                        <span>Modern Browsers (Chrome, Firefox, Safari, Edge)</span>
                                    </div>
                                    <div class="tech-item">
                                        <strong>Responsive:</strong>
                                        <span>Desktop, Tablet, Mobile</span>
                                    </div>
                                </div>
                            </div>

                            <div class="version-roadmap">
                                <h4><i class="fas fa-road"></i> Coming Soon</h4>
                                <div class="roadmap-item">
                                    <i class="fas fa-share-alt"></i>
                                    <span>Enhanced sharing capabilities</span>
                                </div>
                                <div class="roadmap-item">
                                    <i class="fas fa-filter"></i>
                                    <span>Advanced filtering options</span>
                                </div>
                                <div class="roadmap-item">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>Collection statistics and insights</span>
                                </div>
                                <div class="roadmap-item">
                                    <i class="fas fa-mobile-alt"></i>
                                    <span>Offline mobile app</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="save-btn" onclick="closeVersionInfoModal()">Close</button>
                    </div>
                </div>
            </div>

            <!-- Display Preferences Modal -->
            <div class="modal" id="displayPreferencesModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-palette"></i> Display Preferences</h3>
                        <button class="close-btn" onclick="closeDisplayPreferencesModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="preferences-content">
                            <div class="preference-section">
                                <h4><i class="fas fa-volume-up"></i> Sound Settings</h4>
                                
                                <div class="preference-item">
                                    <label class="preference-label">
                                        <input type="checkbox" id="soundEnabledToggle" onchange="toggleSoundSetting()">
                                        <span class="checkmark"></span>
                                        <span class="preference-text">Enable Sounds</span>
                                    </label>
                                    <p class="preference-description">Play audio feedback for interactions</p>
                                </div>
                                
                                <div class="preference-item">
                                    <label class="preference-label">Sound Volume</label>
                                    <div class="volume-control">
                                        <input type="range" id="soundVolumeSlider" min="0" max="100" value="30" onchange="updateSoundVolume(this.value)">
                                        <span id="volumeDisplay">30%</span>
                                    </div>
                                    <p class="preference-description">Adjust the volume of all sounds</p>
                                </div>
                                
                                <div class="sound-test">
                                    <button class="test-sound-btn" onclick="testSounds()">
                                        <i class="fas fa-play"></i> Test Sounds
                                    </button>
                                </div>
                            </div>
                            
                            <div class="preference-section">
                                <h4><i class="fas fa-eye"></i> Visual Settings</h4>
                                
                                <div class="preference-item">
                                    <label class="preference-label">
                                        <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                                        <span class="checkmark"></span>
                                        <span class="preference-text">Dark Mode</span>
                                    </label>
                                    <p class="preference-description">Switch between light and dark themes</p>
                                </div>
                                
                                <div class="preference-item">
                                    <label class="preference-label">Theme</label>
                                    <div class="theme-options">
                                        <div class="theme-option" data-theme="default" onclick="changeTheme('default')" title="Default">
                                            <div class="theme-preview default-theme"></div>
                                            <span>Default</span>
                                        </div>
                                        <div class="theme-option" data-theme="dark" onclick="changeTheme('dark')" title="Dark">
                                            <div class="theme-preview dark-theme"></div>
                                            <span>Dark</span>
                                        </div>
                                        <div class="theme-option" data-theme="ocean" onclick="changeTheme('ocean')" title="Ocean">
                                            <div class="theme-preview ocean-theme"></div>
                                            <span>Ocean</span>
                                        </div>
                                        <div class="theme-option" data-theme="neon" onclick="changeTheme('neon')" title="Neon">
                                            <div class="theme-preview neon-theme"></div>
                                            <span>Neon</span>
                                        </div>
                                        <div class="theme-option" data-theme="forest" onclick="changeTheme('forest')" title="Forest">
                                            <div class="theme-preview forest-theme"></div>
                                            <span>Forest</span>
                                        </div>
                                        <div class="theme-option" data-theme="sunset" onclick="changeTheme('sunset')" title="Sunset">
                                            <div class="theme-preview sunset-theme"></div>
                                            <span>Sunset</span>
                                        </div>
                                    </div>
                                    <p class="preference-description">Choose a color theme for the entire application</p>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="save-btn" onclick="closeDisplayPreferencesModal()">Close</button>
                    </div>
                </div>
            </div>
        </main>
    </div>



    <script src="config.js"></script>
    <script src="ai-config.js"></script>
    <script src="script.js"></script>
</body>
</html>
